# Phase 2.3: ワークアウトUsecase層の実装

**作業日**: 2026-02-07
**担当**: Claude Code
**ステータス**: 完了

## 目的

Phase 2.2（Infrastructure層）が完了し、全リポジトリ実装と統合テストが動作確認済み。Usecase層を実装してExerciseUsecaseとWorkoutUsecaseのビジネスロジックを提供する。

## 作業内容

### 作業開始 - 計画・準備

- 既存のUserUsecaseパターンを確認
- ドメインエンティティ・リポジトリインターフェースを確認
- ブランチ作成: `feature/phase2.3-workout-usecase`

## 変更ファイル

- `backend/usecase/exercise_usecase.go` - ExerciseUsecase実装
- `backend/usecase/exercise_usecase_test.go` - ExerciseUsecaseテスト
- `backend/usecase/workout_usecase.go` - WorkoutUsecase実装
- `backend/usecase/workout_usecase_test.go` - WorkoutUsecaseテスト
- `backend/domain/service/exercise_service_test.go` - ExerciseServiceテスト（新規）
- `backend/domain/service/workout_service_test.go` - WorkoutServiceテスト（新規）

### WorkoutServiceドメインサービス移行

- ExerciseUsecaseのパターンに合わせ、WorkoutUsecaseでもドメインサービスを利用するよう修正
- `ErrDuplicateWorkoutDate`をusecase層からservice層に移動（WorkoutServiceで定義済み）
- `workoutRepo.ExistsByUserIDAndDate`直接参照を`workoutService.CheckDateUniqueness`に変更
- テストも`service.ErrDuplicateWorkoutDate`を参照するよう修正
- ExerciseService / WorkoutService のDB統合テストを追加（UserServiceテストと同パターン）

## 課題・Todo

- [x] ExerciseUsecase実装
- [x] ExerciseUsecaseテスト
- [x] WorkoutUsecase実装
- [x] WorkoutUsecaseテスト
- [x] ExerciseService ドメインサービス作成
- [x] WorkoutService ドメインサービス作成
- [x] WorkoutUsecaseをWorkoutService利用に修正
- [x] WorkoutUsecaseテストをWorkoutService利用に修正
- [x] 全テスト通過確認
- [ ] task-dashboard更新

## 備考

- UserUsecaseのgodocスタイル・テーブル駆動テストパターンに準拠
- トランザクションは将来Phase対応
- ユニーク性チェック等のドメインルールはドメインサービスに集約するClean Architecture方針
